<?php

require __DIR__ . '/vendor/autoload.php';

use Firebase\JWT\JWT;
use Firebase\JWT\Key;

$token = 'eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJSZ2ptRGw1THluekZjdmtYSHZ1Rm8xMXFOUnN0cWxXLXpyZzhDNWl3MVJzIn0.eyJleHAiOjE3NjM3NDk4MzQsImlhdCI6MTc2Mzc0OTUzNCwiYXV0aF90aW1lIjoxNzYzNzQ2MjAyLCJqdGkiOiI5MzNmZDczMi1mOTFiLTQxZGQtYWIxYy1mYjYzZDYyMzNkN2MiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvcmVhbG1zL3RpbWUtd29yay1yZWFsbSIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiJjYTY3NWM1Zi00NjA3LTQ2YTItOWMxNi04ZWE5MGM0MDhjODAiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJhcHAtZnJvbnQiLCJzaWQiOiIwMzAxYTQ1OS0yY2U0LTQxNWItODU0Ny1iMjlmNTY2ZTQ3ODgiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly9sb2NhbGhvc3Q6ODAwMCIsImh0dHA6Ly9sb2NhbGhvc3Q6ODAwMSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJkZWZhdWx0LXJvbGVzLXRpbWUtd29yay1yZWFsbSIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYXBwLWZyb250Ijp7InJvbGVzIjpbInVzZXIiXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoib3BlbmlkIGVtYWlsIHByb2ZpbGUiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJVc2VyIEdyYW0iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJ1c2VyMSIsImdpdmVuX25hbWUiOiJVc2VyIiwiZmFtaWx5X25hbWUiOiJHcmFtIiwiZW1haWwiOiJ1c2VyMUB0ZW0ucGwifQ.nsn_ngOv5dY0FMHBDH9kkyXBoA3_0BNFFZh5NCWX01RFZC3Tq1a0j38wED8gHoCqHNwpCAKRLSf6cH2ihQz9mgzk9U7KLdIl5x2c0bObt_VTr-KQnCti5ZTOk-dli6tdDfl6Ckjpv1suy9goW6Ynas8MlVv-s3soGXhtmD3arvk5PXzwUVF46G0SV8wr0pyljruPsqYYgDkS6JurDblf77Y9bEMshnsANYarvlHTLby1U9TSF8wFn8xoH8iFfBl_dma1hhFkIDszhy45g0l8fAD6KE95AmI5Q71aMuuHrSxlwDp6997T9GFmt5fJVk95LpYUiN0LSB0v8vtVK3ytdA';

$publicKey = <<<PEM
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvuLYA0z9nQSV4osR4dXPq65M5vx5C9VsZvEX1HzqJ9/mTlj8yt3vNUPe/rCOomGiY0iQpvUO9Y9ru504Y2T7Jyc10pAXVyK0Uh2k7zUN0avX4JFawMcHqjd5C8DZI3xXPO5Vo3EGYGaaSMb7xHPeIM8q5VQip5rZd0UqLeHm79BdoHgntIuxjSRD3E6PkSl2cq8Du0Ip7YKJukP3G5Glb9jjiD/+3HbSlFcOkWvGi+Rtx+o8ulCa9taQ2ptd1yzKNN1pJ70cQo+E07FMBBQpSbDYwuXFEX/t8Jcna5ApOvDx5GB2lq87HAD1L5gHjvHzGjJ4obTmI+sWhS9qYzZfqQIDAQAB
-----END PUBLIC KEY-----
PEM;

JWT::$leeway = 0; // na twardo, bez marginesu
$decoded = JWT::decode($token, new Key($publicKey, 'RS256'));

var_dump([
    'now' => time(),
    'exp' => $decoded->exp ?? null,
    'decoded' => $decoded,
]);
